import{a as ee}from"./chunk-3BWVIFHI.js";import{c as Q,h,j as W,k as X,l as Z,q as I,t as u}from"./chunk-6CACEU2V.js";import{F as L}from"./chunk-ZGICK3R3.js";import{H as z,I as K,i as R,k as V,l as $,m as H,o as N,q as G,t as Y}from"./chunk-C2NQIB3Y.js";import{$a as O,Aa as n,Ba as P,Ca as m,F as g,L as T,La as v,M as w,Na as b,Pa as F,V as r,Xa as k,Y as C,Ya as B,aa as p,cb as A,ea as d,ib as M,ja as o,ka as e,kc as q,la as S,pa as j,qa as U,ra as f,za as J}from"./chunk-RFSKJ54S.js";import"./chunk-A2PWH3LV.js";import"./chunk-7KGURMOZ.js";import"./chunk-2ERDAVOU.js";import"./chunk-S2UWYFTU.js";import"./chunk-7DVLVN3P.js";import"./chunk-G3CV3VGG.js";import"./chunk-PXSONQDE.js";import"./chunk-MS5FDQK3.js";import"./chunk-GCVURZBX.js";import"./chunk-4U6PRYVA.js";import"./chunk-BTS5SJXR.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as y,g as E}from"./chunk-OLRFWS6T.js";function ie(t,a){if(t&1&&(o(0,"p")(1,"strong"),n(2,"\u2728 Extras:"),e(),n(3),e()),t&2){let i=f().$implicit;r(3),m(" ",i.selectedExtras,"")}}function ne(t,a){t&1&&(o(0,"div",16),n(1," \u2705 This job has been accepted by a service provider. "),e())}function oe(t,a){t&1&&(o(0,"div",17),n(1," \u23F3 This job is still pending and waiting for a service provider to accept. "),e())}function re(t,a){if(t&1){let i=j();o(0,"ion-card",6)(1,"ion-card-header",7)(2,"ion-card-title",8),n(3),e(),o(4,"p",9),n(5),e()(),o(6,"ion-card-content",10)(7,"p")(8,"strong"),n(9,"\u{1F4C5} Date:"),e(),n(10),v(11,"date"),e(),o(12,"p")(13,"strong"),n(14,"\u{1F559} Time:"),e(),n(15),v(16,"date"),e(),o(17,"p")(18,"strong"),n(19,"\u{1F4B0} Total:"),e(),n(20),e(),p(21,ie,4,1,"p",11)(22,ne,2,0,"div",12)(23,oe,2,0,"div",13),o(24,"div",14)(25,"ion-button",15),U("click",function(){let l=T(i).$implicit,c=f(2);return w(c.goToJob(l))}),n(26," View Details "),e()()()()}if(t&2){let i=a.$implicit;r(3),m(" \u{1F9FD} ",i.serviceType," Cleaning "),r(2),P(i.bookingType),r(5),m(" ",b(11,9,i.selectedTimeAndDate,"mediumDate"),""),r(5),m(" ",b(16,12,i.selectedTimeAndDate,"shortTime"),""),r(5),m(" R",i.totalCostToUser,""),r(),d("ngIf",i.selectedExtras),r(),d("ngIf",i.cleanerID&&i.cleanerID!=="null"),r(),d("ngIf",!i.cleanerID||i.cleanerID==="null"),r(2),d("disabled",!i.cleanerID||i.cleanerID==="null")}}function ae(t,a){if(t&1&&(o(0,"div"),p(1,re,27,15,"ion-card",5),e()),t&2){let i=f();r(),d("ngForOf",i.jobs)}}function se(t,a){t&1&&(o(0,"p",18),n(1,"You have no upcoming jobs."),e())}var be=(()=>{let a=class a{constructor(){this.firestore=g(Q),this.auth=g(L),this.router=g(M),this.jobs=[],this.loading=!0,this.role=null,this.userId=null}ngOnInit(){return E(this,null,function*(){let s=this.auth.currentUser;if(!s){console.warn("User not logged in."),this.loading=!1;return}this.userId=s.uid;let l=W(this.firestore,"users",s.uid),c=yield X(l);if(console.log(c),c.exists()){let x=c.data();this.role=x.role;let _;console.log("User Id : "+s.uid),console.log("User role : "+this.role),this.role==="service-provider"?_=I(h(this.firestore,"service-requests"),u("cleanerID","==",s.uid),u("serviceStatus","in",["Pending","Accepted","Ongoing"])):_=I(h(this.firestore,"service-requests"),u("userId","==",s.uid),u("serviceStatus","in",["Pending","Accepted","Ongoing"]));let te=yield Z(_);this.jobs=te.docs.map(D=>y({id:D.id},D.data()))}else console.warn("User data not found.");this.loading=!1})}goToJob(s){let l={job:s,editMode:!0,role:this.role};this.router.navigateByUrl("/view-service",{state:l})}};a.\u0275fac=function(l){return new(l||a)},a.\u0275cmp=C({type:a,selectors:[["app-upcoming-jobs"]],decls:10,vars:4,consts:[["noJobs",""],[3,"translucent"],[1,"p-4",3,"fullscreen"],[1,"bg-white","rounded-2xl","shadow-md","p-6","space-y-6"],[4,"ngIf","ngIfElse"],["class","mb-4 shadow-md rounded-xl border border-gray-200",4,"ngFor","ngForOf"],[1,"mb-4","shadow-md","rounded-xl","border","border-gray-200"],[1,"bg-gray-100","px-4","py-2","rounded-t-xl"],[1,"text-lg","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"space-y-2"],[4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf"],["class","text-yellow-600 font-medium",4,"ngIf"],[1,"flex","justify-center","mt-4"],["color","dark",3,"click","disabled"],[1,"text-green-600","font-medium"],[1,"text-yellow-600","font-medium"],[1,"text-center","text-white-500","mt-8"]],template:function(l,c){if(l&1&&(o(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),n(3,"upcoming-jobs"),e()()(),o(4,"ion-content",2),S(5,"app-global-background"),o(6,"div",3),p(7,ae,2,1,"div",4),e(),p(8,se,2,0,"ng-template",null,0,F),e()),l&2){let x=J(9);d("translucent",!0),r(4),d("fullscreen",!0),r(3),d("ngIf",c.jobs.length>0)("ngIfElse",x)}},dependencies:[G,Y,z,K,A,k,B,O,q,ee,R,V,N,H,$],encapsulation:2});let t=a;return t})();export{be as UpcomingJobsPage};
