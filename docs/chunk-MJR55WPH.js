import{a as ie}from"./chunk-XWTMKH22.js";import{f as X,k as I,m as Z,n as ee,o as te,t as D,w as u}from"./chunk-L2HEO6U7.js";import{F as W}from"./chunk-JYJCGWMW.js";import{F as L,G as Q,b as R,i as V,j as $,k as H,l as N,m as G,o as Y,q as z,t as K}from"./chunk-RADV76JZ.js";import{F as g,Ja as b,L as w,La as h,M as C,Na as k,V as r,Va as B,Wa as F,Y as S,Za as O,aa as p,ab as A,ea as d,ga as n,gb as M,ha as e,ia as v,ic as q,ma as j,na as U,oa as f,wa as J,xa as o,ya as P,za as m}from"./chunk-KV6L2PIJ.js";import"./chunk-A2PWH3LV.js";import"./chunk-2ERDAVOU.js";import"./chunk-S2UWYFTU.js";import"./chunk-7DVLVN3P.js";import"./chunk-G3CV3VGG.js";import"./chunk-PXSONQDE.js";import"./chunk-MS5FDQK3.js";import"./chunk-GCVURZBX.js";import"./chunk-4U6PRYVA.js";import"./chunk-BTS5SJXR.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as E,g as T}from"./chunk-OLRFWS6T.js";function oe(t,a){if(t&1&&(n(0,"p")(1,"strong"),o(2,"\u2728 Extras:"),e(),o(3),e()),t&2){let i=f().$implicit;r(3),m(" ",i.selectedExtras,"")}}function re(t,a){t&1&&(n(0,"div",17),o(1," \u2705 This job has been accepted by a service provider. "),e())}function ae(t,a){t&1&&(n(0,"div",18),o(1," \u23F3 This job is still pending and waiting for a service provider to accept. "),e())}function se(t,a){if(t&1){let i=j();n(0,"ion-card",7)(1,"ion-card-header",8)(2,"ion-card-title",9),o(3),e(),n(4,"p",10),o(5),e()(),n(6,"ion-card-content",11)(7,"p")(8,"strong"),o(9,"\u{1F4C5} Date:"),e(),o(10),b(11,"date"),e(),n(12,"p")(13,"strong"),o(14,"\u{1F559} Time:"),e(),o(15),b(16,"date"),e(),n(17,"p")(18,"strong"),o(19,"\u{1F4B0} Total:"),e(),o(20),e(),p(21,oe,4,1,"p",12)(22,re,2,0,"div",13)(23,ae,2,0,"div",14),n(24,"div",15)(25,"ion-button",16),U("click",function(){let l=w(i).$implicit,c=f(2);return C(c.goToJob(l))}),o(26," View Details "),e()()()()}if(t&2){let i=a.$implicit;r(3),m(" \u{1F9FD} ",i.serviceType," Cleaning "),r(2),P(i.bookingType),r(5),m(" ",h(11,9,i.selectedTimeAndDate,"mediumDate"),""),r(5),m(" ",h(16,12,i.selectedTimeAndDate,"shortTime"),""),r(5),m(" R",i.totalCostToUser,""),r(),d("ngIf",i.selectedExtras),r(),d("ngIf",i.cleanerID&&i.cleanerID!=="null"),r(),d("ngIf",!i.cleanerID||i.cleanerID==="null"),r(2),d("disabled",!i.cleanerID||i.cleanerID==="null")}}function le(t,a){if(t&1&&(n(0,"div"),p(1,se,27,15,"ion-card",6),e()),t&2){let i=f();r(),d("ngForOf",i.jobs)}}function de(t,a){t&1&&(n(0,"p",19),o(1,"You have no upcoming jobs."),e())}var Ie=(()=>{let a=class a{constructor(){this.firestore=g(X),this.auth=g(W),this.router=g(M),this.jobs=[],this.loading=!0,this.role=null,this.userId=null}ngOnInit(){return T(this,null,function*(){let s=this.auth.currentUser;if(!s){console.warn("User not logged in."),this.loading=!1;return}this.userId=s.uid;let l=Z(this.firestore,"users",s.uid),c=yield ee(l);if(console.log(c),c.exists()){let x=c.data();this.role=x.role;let _;console.log("User Id : "+s.uid),console.log("User role : "+this.role),this.role==="service-provider"?_=D(I(this.firestore,"service-requests"),u("cleanerID","==",s.uid),u("serviceStatus","in",["Pending","Accepted","Ongoing"])):_=D(I(this.firestore,"service-requests"),u("userId","==",s.uid),u("serviceStatus","in",["Pending","Accepted","Ongoing"]));let ne=yield te(_);this.jobs=ne.docs.map(y=>E({id:y.id},y.data()))}else console.warn("User data not found.");this.loading=!1})}goToJob(s){let l={job:s,editMode:!0,role:this.role};this.router.navigateByUrl("/view-service",{state:l})}};a.\u0275fac=function(l){return new(l||a)},a.\u0275cmp=S({type:a,selectors:[["app-upcoming-jobs"]],decls:12,vars:4,consts:[["noJobs",""],[3,"translucent"],["slot","start"],[1,"p-4",3,"fullscreen"],[1,"bg-white","rounded-2xl","shadow-md","p-6","space-y-6"],[4,"ngIf","ngIfElse"],["class","mb-4 shadow-md rounded-xl border border-gray-200",4,"ngFor","ngForOf"],[1,"mb-4","shadow-md","rounded-xl","border","border-gray-200"],[1,"bg-gray-100","px-4","py-2","rounded-t-xl"],[1,"text-lg","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"space-y-2"],[4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf"],["class","text-yellow-600 font-medium",4,"ngIf"],[1,"flex","justify-center","mt-4"],["color","dark",3,"click","disabled"],[1,"text-green-600","font-medium"],[1,"text-yellow-600","font-medium"],[1,"text-center","text-white-500","mt-8"]],template:function(l,c){if(l&1&&(n(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),v(3,"ion-back-button"),e(),n(4,"ion-title"),o(5,"upcoming-jobs"),e()()(),n(6,"ion-content",3),v(7,"app-global-background"),n(8,"div",4),p(9,le,2,1,"div",5),e(),p(10,de,2,0,"ng-template",null,0,k),e()),l&2){let x=J(11);d("translucent",!0),r(6),d("fullscreen",!0),r(3),d("ngIf",c.jobs.length>0)("ngIfElse",x)}},dependencies:[R,$,z,K,L,Q,A,B,F,O,q,ie,V,H,Y,G,N],encapsulation:2});let t=a;return t})();export{Ie as UpcomingJobsPage};
