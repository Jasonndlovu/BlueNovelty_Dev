import{a as j}from"./chunk-FYLT2MHV.js";import{a as H}from"./chunk-GJRON2FT.js";import"./chunk-L2HEO6U7.js";import"./chunk-JYJCGWMW.js";import{A as z,F as $,G as R,b as D,c as S,h as w,i as k,j as M,k as T,l as O,m as P,o as N,p as U,q as V,t as F,w as B}from"./chunk-RADV76JZ.js";import{L as g,M as x,V as l,Va as A,W as _,Wa as E,Y as v,aa as m,ab as C,ea as b,ga as n,gb as y,ha as t,ia as I,ic as J,ma as f,na as u,oa as d,xa as r,ya as h,za as p}from"./chunk-KV6L2PIJ.js";import"./chunk-A2PWH3LV.js";import"./chunk-2ERDAVOU.js";import"./chunk-S2UWYFTU.js";import"./chunk-7DVLVN3P.js";import"./chunk-G3CV3VGG.js";import"./chunk-PXSONQDE.js";import"./chunk-MS5FDQK3.js";import"./chunk-GCVURZBX.js";import"./chunk-4U6PRYVA.js";import"./chunk-BTS5SJXR.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-OLRFWS6T.js";function q(a,s){a&1&&(n(0,"ion-badge",6),r(1,"Available"),t())}function L(a,s){if(a&1){let o=f();n(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),r(3),t(),m(4,q,2,0,"ion-badge",3),t(),n(5,"ion-card-content")(6,"p"),r(7),t(),n(8,"p"),r(9),t(),n(10,"ion-row")(11,"ion-col")(12,"ion-button",4),u("click",function(){let i=g(o).$implicit,c=d();return x(c.acceptJob(i,c.user))}),r(13,"Accept"),t()(),n(14,"ion-col")(15,"ion-button",5),u("click",function(){let i=g(o).$implicit,c=d();return x(c.declineJob(i))}),r(16,"Decline"),t()()()()()}if(a&2){let o=s.$implicit,e=d();l(3),h(o.selectedProperty==null?null:o.selectedProperty.propertyType),l(),b("ngIf",o.isAvailable),l(3),p("Client: ",e.userNames[o.userId]||"Unknown",""),l(2),p("Extras: ",o.selectedExtras,"")}}function W(a,s){if(a&1&&(n(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),r(3),t()(),n(4,"ion-card-content")(5,"p")(6,"strong"),r(7,"Extras:"),t(),r(8),t(),n(9,"p")(10,"strong"),r(11,"Status:"),t(),r(12),t(),n(13,"p")(14,"strong"),r(15,"Created At:"),t(),r(16),t()()()),a&2){let o=d(2);l(3),h(o.selectedJob.selectedProperty),l(5),p(" ",o.selectedJob.selectedExtras,""),l(4),p(" ",o.selectedJob.isAvailable?"Available":"Assigned",""),l(4),p(" ",o.selectedJob.createdAt,"")}}function G(a,s){if(a&1){let o=f();n(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),r(3,"Job Details"),t(),n(4,"ion-buttons",7)(5,"ion-button",8),u("click",function(){g(o);let i=d();return x(i.closeModal())}),r(6,"Close"),t()()()(),n(7,"ion-content"),m(8,W,17,4,"ion-card",9),t()}if(a&2){let o=d();l(8),b("ngIf",o.selectedJob)}}var oe=(()=>{let s=class s{constructor(e,i,c){this.availableJobsService=e,this.authService=i,this.router=c,this.user=null,this.jobs=[],this.userNames={},this.isModalOpen=!1}ngOnInit(){this.fetchUserDetails(),this.getAvailableJobs()}getAvailableJobs(){this.availableJobsService.getServiceReviews().subscribe(e=>{this.jobs=e,this.fetchUserNames()},e=>{console.error("Error fetching available jobs:",e)})}fetchUserNames(){this.jobs.forEach(e=>{e.userId&&!this.userNames[e.userId]&&this.availableJobsService.getUserName(e.userId).subscribe(i=>{this.userNames[e.userId]=i})})}acceptJob(e,i){if(!i){console.error("User is not logged in");return}if(!e.id){console.error("Job ID is undefined");return}this.router.navigate(["/accept-service"],{state:{userId:i.uid,userName:i.displayName,jobId:e.id,jobType:e.serviceType,jobBookingType:e.bookingType,jobIsAvailable:e.isAvailable,scheduledDate:e.selectedTimeAndDate,price:e.totalCostToUser,toDo:e.selectedExtras,bookingFrequency:e.recurringOption,additionalInfo:e.additionalInfo,recurringDate:e.recurringDate,recurringDay:e.recurringDay,recurringOption:e.recurringOption}})}declineJob(e){e.isAvailable=!0,console.log(`Declined job: ${e.id}`)}fetchUserDetails(){this.authService.getCurrentUser().subscribe(e=>{this.user=e})}viewInfo(e){this.selectedJob=e,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}};s.\u0275fac=function(i){return new(i||s)(_(j),_(H),_(y))},s.\u0275cmp=v({type:s,selectors:[["app-available-jobs"]],decls:11,vars:2,consts:[["slot","start"],[4,"ngFor","ngForOf"],[3,"ionModalDidDismiss","isOpen"],["color","primary",4,"ngIf"],[1,"Accept",3,"click"],[1,"Decline",3,"click"],["color","primary"],["slot","end"],[3,"click"],[4,"ngIf"]],template:function(i,c){i&1&&(n(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),I(3,"ion-back-button"),t(),n(4,"ion-title"),r(5,"Available Jobs"),t()()(),n(6,"ion-content")(7,"ion-list"),m(8,L,17,4,"ion-card",1),t(),n(9,"ion-modal",2),u("ionModalDidDismiss",function(){return c.closeModal()}),m(10,G,9,1,"ng-template"),t()()),i&2&&(l(8),b("ngForOf",c.jobs),l(),b("isOpen",c.isModalOpen))},dependencies:[S,U,z,k,O,N,P,T,B,D,M,w,V,F,$,R,C,A,E,J],styles:["ion-badge[_ngcontent-%COMP%]{font-size:.8rem;padding:5px 10px;border-radius:5px}ion-card[_ngcontent-%COMP%]{margin-bottom:10px}.Accept[_ngcontent-%COMP%]{margin:0 auto;width:60%;font-size:.8rem;height:10px;text-align:center;font-style:normal;font-weight:700;font-size:10px;line-height:100%;--background: #1E232C;--color: White;--border-radius: 100px;--border-color: #000;--border-style: solid;--border-width: 1px;--box-shadow: 0 2px 6px 0 rgb(0, 0, 0, .25);--ripple-color: deeppink;--padding-top: 10px;--padding-bottom: 10px}.Decline[_ngcontent-%COMP%]{margin:0 auto;width:60%;font-size:.8rem;height:10px;text-align:center;font-style:normal;font-weight:700;font-size:10px;line-height:18px;--background: #DADADA;--color: black;--border-radius: 100px;--border-color: #000;--border-style: solid;--border-width: 1px;--box-shadow: 0 2px 6px 0 rgb(0, 0, 0, .25);--ripple-color: deeppink;--padding-top: 10px;--padding-bottom: 10px}"]});let a=s;return a})();export{oe as AvailableJobsPage};
