import{a as W}from"./chunk-YCA6ITIU.js";import{a as L}from"./chunk-ZZSRRRLF.js";import"./chunk-6CACEU2V.js";import"./chunk-ZGICK3R3.js";import{C as R,H as j,I as q,b as T,c as M,h as k,i as P,j as O,k as N,l as U,m as F,o as V,p as B,q as z,t as H,w as $}from"./chunk-C2NQIB3Y.js";import{$a as f,Aa as o,Ba as v,Ca as d,Ha as A,L as x,M as _,V as l,W as m,Xa as E,Y as D,Ya as y,aa as b,cb as C,ea as u,ib as J,ja as n,ka as t,kc as w,la as S,pa as h,qa as g,ra as p}from"./chunk-RFSKJ54S.js";import"./chunk-A2PWH3LV.js";import"./chunk-7KGURMOZ.js";import"./chunk-2ERDAVOU.js";import"./chunk-S2UWYFTU.js";import"./chunk-7DVLVN3P.js";import"./chunk-G3CV3VGG.js";import"./chunk-PXSONQDE.js";import"./chunk-MS5FDQK3.js";import"./chunk-GCVURZBX.js";import"./chunk-4U6PRYVA.js";import"./chunk-BTS5SJXR.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-OLRFWS6T.js";function G(a,s){a&1&&(n(0,"ion-badge",6),o(1,"Available"),t())}function K(a,s){if(a&1){let i=h();n(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),o(3),t(),b(4,G,2,0,"ion-badge",3),t(),n(5,"ion-card-content")(6,"p"),o(7),t(),n(8,"p"),o(9),t(),n(10,"p"),o(11),t(),n(12,"ion-row")(13,"ion-col")(14,"ion-button",4),g("click",function(){let r=x(i).$implicit,c=p();return _(c.acceptJob(r,c.user))}),o(15,"Accept"),t()(),n(16,"ion-col")(17,"ion-button",5),g("click",function(){let r=x(i).$implicit,c=p();return _(c.declineJob(r))}),o(18,"Decline"),t()()()()()}if(a&2){let i=s.$implicit,e=p();l(3),v(i.selectedProperty==null?null:i.selectedProperty.propertyType),l(),u("ngIf",i.isAvailable),l(3),d("Client: ",e.userNames[i.userId]||"Unknown",""),l(2),d("Extras: ",i.selectedExtras,""),l(2),d("Scheduled for: ",e.formatScheduledDate(i.selectedTimeAndDate),"")}}function Q(a,s){if(a&1&&(n(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),o(3),t()(),n(4,"ion-card-content")(5,"p")(6,"strong"),o(7,"Extras:"),t(),o(8),t(),n(9,"p")(10,"strong"),o(11,"Scheduled Time:"),t(),o(12),t(),n(13,"p")(14,"strong"),o(15,"Status:"),t(),o(16),t(),n(17,"p")(18,"strong"),o(19,"Created At:"),t(),o(20),t()()()),a&2){let i=p(2);l(3),v(i.selectedJob.selectedProperty),l(5),d(" ",i.selectedJob.selectedExtras,""),l(4),d(" ",i.formatScheduledDate(i.selectedJob.selectedTimeAndDate),""),l(4),d(" ",i.selectedJob.isAvailable?"Available":"Assigned",""),l(4),d(" ",i.selectedJob.createdAt,"")}}function X(a,s){if(a&1){let i=h();n(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),o(3,"Job Details"),t(),n(4,"ion-buttons",7)(5,"ion-button",8),g("click",function(){x(i);let r=p();return _(r.closeModal())}),o(6,"Close"),t()()()(),n(7,"ion-content"),b(8,Q,21,5,"ion-card",9),t()}if(a&2){let i=p();l(8),u("ngIf",i.selectedJob)}}var le=(()=>{let s=class s{constructor(e,r,c,I){this.availableJobsService=e,this.datePipe=r,this.authService=c,this.router=I,this.user=null,this.jobs=[],this.userNames={},this.isModalOpen=!1}ngOnInit(){this.fetchUserDetails(),this.getAvailableJobs()}formatScheduledDate(e){return this.datePipe.transform(e,"HH:mm yyyy-MM-dd")||""}getAvailableJobs(){this.availableJobsService.getServiceReviews().subscribe(e=>{this.jobs=e,this.fetchUserNames()},e=>{console.error("Error fetching available jobs:",e)})}fetchUserNames(){this.jobs.forEach(e=>{e.userId&&!this.userNames[e.userId]&&this.availableJobsService.getUserName(e.userId).subscribe(r=>{this.userNames[e.userId]=r})})}acceptJob(e,r){if(!r){console.error("User is not logged in");return}if(!e.id){console.error("Job ID is undefined");return}this.router.navigate(["/accept-service"],{state:{userId:r.uid,userName:r.displayName,jobId:e.id,jobType:e.serviceType,jobBookingType:e.bookingType,jobIsAvailable:e.isAvailable,scheduledDate:e.selectedTimeAndDate,price:e.totalCostToUser,toDo:e.selectedExtras,bookingFrequency:e.recurringOption,additionalInfo:e.additionalInfo,recurringDate:e.recurringDate,recurringDay:e.recurringDay,recurringOption:e.recurringOption}})}declineJob(e){e.isAvailable=!0,console.log(`Declined job: ${e.id}`)}fetchUserDetails(){this.authService.getCurrentUser().subscribe(e=>{this.user=e})}viewInfo(e){this.selectedJob=e,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}};s.\u0275fac=function(r){return new(r||s)(m(W),m(f),m(L),m(J))},s.\u0275cmp=D({type:s,selectors:[["app-available-jobs"]],features:[A([f])],decls:11,vars:2,consts:[["slot","start"],[4,"ngFor","ngForOf"],[3,"ionModalDidDismiss","isOpen"],["color","primary",4,"ngIf"],[1,"Accept",3,"click"],[1,"Decline",3,"click"],["color","primary"],["slot","end"],[3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(n(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),S(3,"ion-back-button"),t(),n(4,"ion-title"),o(5,"Available Jobs"),t()()(),n(6,"ion-content")(7,"ion-list"),b(8,K,19,5,"ion-card",1),t(),n(9,"ion-modal",2),g("ionModalDidDismiss",function(){return c.closeModal()}),b(10,X,9,1,"ng-template"),t()()),r&2&&(l(8),u("ngForOf",c.jobs),l(),u("isOpen",c.isModalOpen))},dependencies:[M,B,R,P,U,V,F,N,$,T,O,k,z,H,j,q,C,E,y,w],styles:["ion-badge[_ngcontent-%COMP%]{font-size:.8rem;padding:5px 10px;border-radius:5px}ion-card[_ngcontent-%COMP%]{margin-bottom:10px}.Accept[_ngcontent-%COMP%]{margin:0 auto;width:60%;font-size:.8rem;height:10px;text-align:center;font-style:normal;font-weight:700;font-size:10px;line-height:100%;--background: #1E232C;--color: White;--border-radius: 100px;--border-color: #000;--border-style: solid;--border-width: 1px;--box-shadow: 0 2px 6px 0 rgb(0, 0, 0, .25);--ripple-color: deeppink;--padding-top: 10px;--padding-bottom: 10px}.Decline[_ngcontent-%COMP%]{margin:0 auto;width:60%;font-size:.8rem;height:10px;text-align:center;font-style:normal;font-weight:700;font-size:10px;line-height:18px;--background: #DADADA;--color: black;--border-radius: 100px;--border-color: #000;--border-style: solid;--border-width: 1px;--box-shadow: 0 2px 6px 0 rgb(0, 0, 0, .25);--ripple-color: deeppink;--padding-top: 10px;--padding-bottom: 10px}"]});let a=s;return a})();export{le as AvailableJobsPage};
