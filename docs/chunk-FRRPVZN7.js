import{x as he}from"./chunk-LEEZS73E.js";import"./chunk-36AM222O.js";import"./chunk-7QQQ4XSS.js";import"./chunk-E66F5ZP3.js";import"./chunk-HC6MZPB3.js";import"./chunk-2SDYHWHI.js";import"./chunk-4PGTP63H.js";import"./chunk-FW7FQTSR.js";import"./chunk-FERD25SW.js";import"./chunk-HMTYJH34.js";import"./chunk-VFZRLGVJ.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-C5FLGXKQ.js";import"./chunk-Q7SJDITE.js";import"./chunk-MCRJI3T3.js";import"./chunk-MM5QLNJM.js";import"./chunk-NHOGAROI.js";import"./chunk-72KDLSWN.js";import{B as me,E as pe,H as ue,h as w,q as C,u as D,x as de,y as E}from"./chunk-BKWKOILY.js";import{G as re,H as ae,J as se,K as le,N as ce,c as K,e as Y,i as H,j as J,k as Q,l as X,m as Z,o as $,q as ee,t as te,u as ie,v as ne,w as oe}from"./chunk-FYZ4SEYQ.js";import{$ as P,A as S,Aa as B,Ba as f,Ca as k,D as T,Da as M,Ea as V,K as u,L as h,Ob as N,Ra as U,Rb as G,Sa as W,U as c,V as b,Wa as L,X as q,Zb as z,da as g,ea as R,ia as r,ja as n,ka as I,oa as v,pa as y,qa as m,za as l}from"./chunk-C7Y544BQ.js";import"./chunk-A2PWH3LV.js";import"./chunk-7KGURMOZ.js";import"./chunk-2ERDAVOU.js";import"./chunk-S2UWYFTU.js";import"./chunk-7DVLVN3P.js";import"./chunk-G3CV3VGG.js";import"./chunk-PXSONQDE.js";import"./chunk-MS5FDQK3.js";import"./chunk-GCVURZBX.js";import"./chunk-4U6PRYVA.js";import"./chunk-BTS5SJXR.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as F,b as j,g as p}from"./chunk-OLRFWS6T.js";var _e=(()=>{let a=class a{constructor(t,e){this.firestore=t,this.auth=e}createServiceRequest(t){return p(this,null,function*(){let e=this.auth.currentUser;if(!e)throw new Error("User not logged in");let o={userId:e.uid,selectedProperty:t.selectedProperty,selectedExtras:t.selectedExtras,selectedTimeAndDate:t.selectedTimeAndDate,isAvailable:!0,cleanerID:"null",createdAt:C.now()},_=E(this.firestore,"service-requests");try{let d=yield de(_,o);return console.log("Service request successfully added with ID:",d.id),d.id}catch(d){throw console.error("Error adding service request:",d),new Error("Error adding service request: "+d)}})}};a.\u0275fac=function(e){return new(e||a)(T(D),T(w))},a.\u0275prov=S({token:a,factory:a.\u0275fac,providedIn:"root"});let s=a;return s})();var xe=(()=>{let a=class a{constructor(t,e){this.firestore=t,this.auth=e}getUserProperties(t){return p(this,null,function*(){console.log("Fetching properties for userId:",t);let e=E(this.firestore,"user-property"),o=pe(e,ue("userId","==",t)),_=yield me(o);return console.log("Found",_.size,"properties"),_.docs.map(d=>{let x=d.data();return console.log("property data:",x),j(F({id:d.id},x),{createdAt:x.createdAt instanceof C?x.createdAt.toDate():new Date})})})}};a.\u0275fac=function(e){return new(e||a)(T(D),T(w))},a.\u0275prov=S({token:a,factory:a.\u0275fac,providedIn:"root"});let s=a;return s})();function be(s,a){if(s&1&&(r(0,"div",2)(1,"h1"),l(2,"Let's get you started"),n(),r(3,"ion-item")(4,"ion-label"),l(5,"Details About Your Place"),n(),r(6,"ion-button",3),l(7,"Select"),n(),I(8,"ion-action-sheet",4),n()()),s&2){let i=m();c(8),g("buttons",i.actionSheetButtons)}}function Se(s,a){if(s&1){let i=v();r(0,"ion-item",12),I(1,"ion-icon",13),r(2,"ion-label",14),l(3),n(),r(4,"ion-checkbox",15),V("ngModelChange",function(e){let o=u(i).$implicit;return M(o.selected,e)||(o.selected=e),h(e)}),y("ionChange",function(){let e=u(i).$implicit,o=m(2);return h(o.onCheckboxChange(e))}),n()()}if(s&2){let i=a.$implicit;R("selected",i.selected),c(),g("name",i.icon),c(2),B(i.name),c(),k("ngModel",i.selected)}}function Pe(s,a){if(s&1){let i=v();r(0,"div",2)(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title"),l(4,"Details About Your Clean"),n()(),r(5,"ion-card-content")(6,"p")(7,"strong"),l(8,"Location:"),n(),l(9),n(),r(10,"ul")(11,"li"),l(12),n(),r(13,"li"),l(14),n(),r(15,"li"),l(16),n(),r(17,"li"),l(18),n(),r(19,"li"),l(20),n(),r(21,"li"),l(22),n()(),I(23,"ion-textarea",5),r(24,"p",6)(25,"strong"),l(26,"Note to developer:"),n(),l(27," This will not be stored in the backend but used to prepopulate the agreement page. "),n(),r(28,"ion-item",7),y("click",function(){u(i);let e=m();return h(e.openDateTimePicker())}),r(29,"ion-label"),l(30,"Choose Date & Time"),n(),I(31,"ion-icon",8),n(),r(32,"h3"),l(33,"Extras"),n(),r(34,"ion-list"),P(35,Se,5,5,"ion-item",9),n(),r(36,"p",10),l(37,"GET 15% DISCOUNT FOR RECURRING BOOKINGS"),n(),r(38,"ion-button",11),y("click",function(){u(i);let e=m();return h(e.getCleaner())}),l(39," Lets Get Your Cleaner "),n()()()()}if(s&2){let i=m();c(9),f(" ",i.selectedProperty==null?null:i.selectedProperty.location,""),c(3),f("Bedrooms: ",i.selectedProperty==null?null:i.selectedProperty.numberOfBedrooms,""),c(2),f("Bathrooms: ",i.selectedProperty==null?null:i.selectedProperty.numberOfBathrooms,""),c(2),f("Living Rooms: ",i.selectedProperty==null?null:i.selectedProperty.numberOfLivingRooms,""),c(2),f("Kitchens: ",i.selectedProperty==null?null:i.selectedProperty.numberOfKitchens,""),c(2),f("Garages: ",i.selectedProperty==null?null:i.selectedProperty.numberOfGarages,""),c(2),f("Floors: ",i.selectedProperty==null?null:i.selectedProperty.numberOfFloors,""),c(13),g("ngForOf",i.extras)}}function ve(s,a){if(s&1){let i=v();r(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",16)(3,"ion-button",17),y("click",function(){u(i);let e=m();return h(e.closeDateTimePicker())}),l(4,"Cancel"),n()(),r(5,"ion-title"),l(6,"Date and Time"),n(),r(7,"ion-buttons",18)(8,"ion-button",19),y("click",function(){u(i);let e=m();return h(e.confirmSelection())}),l(9,"Confirm"),n()()()(),r(10,"ion-content",20)(11,"ion-datetime",21),V("ngModelChange",function(e){u(i);let o=m();return M(o.selectedDate_Time,e)||(o.selectedDate_Time=e),h(e)}),y("ionChange",function(e){u(i);let o=m();return h(o.validateTime(e))}),n()()}if(s&2){let i=m();c(8),g("strong",!0),c(3),k("ngModel",i.selectedDate_Time),g("isDateEnabled",i.isWeekday)("min",i.minDate)("max",i.maxDate)}}var Ue=(()=>{let a=class a{constructor(t,e,o,_){this.toastController=t,this.serviceRequestService=e,this.auth=o,this.propertyService=_,this.step=1,this.selectedDate_Time=null,this.showDateTimeModal=!1,this.user=null,this.property=[],this.actionSheetButtons=[],this.isTimeValid=!0,this.restrictedStartTime="09:00",this.restrictedEndTime="17:00",this.extras=[{name:"Ironing",icon:"shirt-outline",selected:!1},{name:"Inside Fridge",icon:"snow-outline",selected:!1},{name:"Garage",icon:"car-outline",selected:!1},{name:"Inside Cabinets",icon:"briefcase-outline",selected:!1},{name:"Interior Windows",icon:"albums-outline",selected:!1},{name:"Interior Walls",icon:"business-outline",selected:!1},{name:"Laundry",icon:"water-outline",selected:!1}],this.isWeekday=ye=>{let A=new Date(ye).getUTCDay();return A!==0&&A!==6};let d=new Date,x=new Date;x.setDate(d.getDate()+1);let O=new Date;O.setMonth(d.getMonth()+1),this.minDate=x.toISOString().split("T")[0],this.maxDate=O.toISOString().split("T")[0]}ngOnInit(){console.log("hit button"),this.auth.onAuthStateChanged(t=>p(this,null,function*(){t?(this.user=t,console.log("User Details:",this.user),yield this.loadUserProperties()):console.log("No user is logged in.")}))}validateTime(t){let o=new Date(t.detail.value).toTimeString().split(" ")[0];o<this.restrictedStartTime||o>this.restrictedEndTime?(console.log("This time is restricted"),this.selectedDate_Time=null,this.isTimeValid=!1):this.isTimeValid=!0}openDateTimePicker(){this.showDateTimeModal=!0}closeDateTimePicker(){this.showDateTimeModal=!1}showToast(t){return p(this,null,function*(){(yield this.toastController.create({message:t,duration:2e3,position:"top",color:"danger"})).present()})}confirmSelection(){if(console.log("Selected Date:",this.selectedDate_Time),this.selectedDate_Time!=null){let e=new Date(this.selectedDate_Time).toTimeString().split(" ")[0];e<this.restrictedStartTime||e>this.restrictedEndTime?(console.log("Time is outside the allowed range"),this.showToast("Selected time is outside the allowed range! 09:00 - 17:00"),this.isTimeValid=!1):(this.isTimeValid=!0,this.showDateTimeModal=!1)}else this.showToast("Please select a valid date and time! 09:00 - 17:00")}onCheckboxChange(t){t.selected=!t.selected}getCleaner(){return p(this,null,function*(){var e;let t=this.extras.filter(o=>o.selected).map(o=>o.name).join(", ");try{let o=yield this.serviceRequestService.createServiceRequest({userId:(e=this.auth.currentUser)==null?void 0:e.uid,selectedProperty:this.selectedProperty,selectedExtras:t,selectedTimeAndDate:this.selectedDate_Time,createdAt:new Date});console.log("Service request created with ID:",o),(yield this.toastController.create({message:"A job post has been created, you will be notified as soon as it is accepted by a cleaner",duration:2e3,position:"top",color:"success"})).present()}catch(o){console.error("Error creating service request:",o)}})}loadUserProperties(){return p(this,null,function*(){if(this.user){console.log("user found");try{this.property=yield this.propertyService.getUserProperties(this.user.uid),console.log("User Properties:",this.property),this.actionSheetButtons=this.property.map(t=>({text:t.propertyType,handler:()=>{this.selectedProperty=t,this.step=2}}))}catch(t){console.error("Error fetching properties:",t)}}})}};a.\u0275fac=function(e){return new(e||a)(b(he),b(_e),b(w),b(xe))},a.\u0275cmp=q({type:a,selectors:[["app-property-information"]],decls:7,vars:3,consts:[["class","Property-container",4,"ngIf"],[3,"isOpen"],[1,"Property-container"],["id","open-action-sheet"],["trigger","open-action-sheet","header","Select property type...",3,"buttons"],["placeholder","Tell us any additional information..."],[1,"note"],["button","",3,"click"],["slot","end","name","calendar"],["class","pill-item",3,"selected",4,"ngFor","ngForOf"],[1,"discount"],["expand","block","color","dark",3,"click"],[1,"pill-item"],["slot","start",3,"name"],["color","dark"],["name","extraItem",1,"layered-checkbox",3,"ngModelChange","ionChange","ngModel"],["slot","start"],[3,"click"],["slot","end"],["expand","full",3,"click","strong"],[1,"ion-padding"],["name","selectedDateTime",3,"ngModelChange","ionChange","ngModel","isDateEnabled","min","max"]],template:function(e,o){e&1&&(r(0,"ion-header"),I(1,"ion-toolbar"),n(),r(2,"ion-content"),P(3,be,9,1,"div",0)(4,Pe,40,8,"div",0),n(),r(5,"ion-modal",1),P(6,ve,12,5,"ng-template"),n()),e&2&&(c(3),g("ngIf",o.step===1),c(),g("ngIf",o.step===2),c(),g("isOpen",o.showDateTimeModal))},dependencies:[se,K,Y,ne,ie,oe,ce,X,$,Z,Q,le,H,J,ee,te,re,ae,L,U,W,z,N,G],styles:[".toast[_ngcontent-%COMP%]{background-color:red;color:#fff;font-weight:700}ion-button[_ngcontent-%COMP%]{margin:0 auto;font-size:.8rem;height:40px;text-align:center;font-style:normal;font-weight:700;font-size:15px;line-height:10px;--background: #1E232C;--color: White;--border-radius: 8px;--border-color: #000;--border-style: solid;--border-width: 1px;--box-shadow: 0 2px 6px 0 rgb(0, 0, 0, .25);--ripple-color: rgba(255, 20, 145, 0);--padding-top: 10px;--padding-bottom: 10px}ion-item[_ngcontent-%COMP%]{background:#1e1e1e00}"]});let s=a;return s})();export{Ue as PropertyInformationPage};
